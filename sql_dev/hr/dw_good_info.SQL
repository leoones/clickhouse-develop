truncate table dw_hr.dw_good_info;

insert into dw_hr.dw_good_info(
   buid ,
	categoryid ,
	categorytreeid ,
	sysgoodsid ,
	goodsid ,
	goodscode ,
	goodsname ,
	barcode ,
	unitname ,
	inbuid ,
	producingarea ,
	adviceprice ,
	advicecost ,
	addrate ,
	brandid ,
	categoryname ,
	mid_categoryid ,
	mid_categoryname ,
	h_categoryid ,
	h_categoryname 
    )
select jdi.buid,
            jdi.categoryid as categoryid_new,
            toUInt8(dictGet('dw_buinfo', 'categorytreeid', tuple(buid))) as categorytreeid_new,
            jdi.sysgoodsid,
            jdi.goodsid,
            jdi.goodscode,
            jdi.goodsname,
            jdi.barcode,
            jdi.unitname,
            jdi.inbuid,
            jdi.producingarea,
            jdi.adviceprice,
            jdi.advicecost,
            jdi.addrate,
            jdi.brandid,
           dictGet('dw_category_info', 'categoryname', (categorytreeid_new, categoryid_new))     AS categoryname,
           dictGet('dw_category_info', 'mid_categoryid', (categorytreeid_new, categoryid_new))   AS mid_categoryid,
           dictGet('dw_category_info', 'mid_categoryname', (categorytreeid_new, categoryid_new)) AS mid_categoryname,
           dictGet('dw_category_info', 'h_categoryid', (categorytreeid_new, categoryid_new))     AS h_categoryid,
           dictGet('dw_category_info', 'h_categoryname', (categorytreeid_new, categoryid_new))   AS h_categoryname
      from ods_hr.jv_goods jdi